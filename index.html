<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renunber - Memory Challenge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle at top left, #f8fafc, #e2e8f0);
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        @keyframes success-pulse {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }
        .pulse-success { animation: success-pulse 1s ease-out; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake { animation: shake 0.2s ease-in-out 0s 2; }
    </style>
</head>
<body class="flex items-center justify-center p-4">

    <div id="sr-announcer" class="sr-only" aria-live="assertive"></div>

    <div id="game-container" class="glass-card w-full max-w-md rounded-3xl shadow-2xl overflow-hidden p-8 space-y-8 relative">
        
        <!-- Header -->
        <div class="flex justify-between items-center text-sm font-semibold text-slate-500 uppercase tracking-wider">
            <div class="flex flex-col">
                <span>Score: <span id="display-score" class="text-blue-600 font-bold">0</span></span>
                <span class="text-[10px]">Best: <span id="display-high-score">0</span></span>
            </div>
            <div id="level-indicator" class="bg-slate-100 px-3 py-1 rounded-full text-blue-600 font-bold">Level 1</div>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="text-center space-y-6">
            <div class="w-20 h-20 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-xl shadow-blue-200">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" />
                </svg>
            </div>
            <h1 class="text-4xl font-extrabold text-slate-800 leading-tight" tabindex="-1">Renunber</h1>
            <p class="text-slate-600 text-sm leading-relaxed">
                Welcome to remember the numbers or Renunber. In each level you will be given a sequence of numbers that will vanish. Afterwards, you have to type the sequence in. If you get the sequence correct, you will move on to the next level. The game will progressively get more difficult as you progress and the number of digits will increase gradually.
            </p>
            <button onclick="Game.start()" class="w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl font-bold text-lg shadow-lg shadow-blue-200 transition-all active:scale-95">
                Start Game
            </button>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="hidden space-y-6">
            <div id="memorize-area" class="py-8">
                <div id="number-display" class="text-5xl font-black text-center text-slate-800 tracking-widest min-h-[4rem] transition-opacity duration-300" aria-hidden="true"></div>
            </div>

            <div id="input-area" class="hidden space-y-6">
                <div class="relative">
                    <label for="user-input" class="block text-center text-slate-600 font-semibold mb-2">Type the numbers you heard:</label>
                    <input type="text" id="user-input" 
                           inputmode="numeric" pattern="[0-9]*" autocomplete="off"
                           placeholder="Enter digits..."
                           class="w-full text-center py-5 text-3xl font-bold border-4 border-slate-100 rounded-2xl focus:border-blue-400 focus:outline-none transition-colors">
                    
                    <p id="error-message" class="hidden text-red-500 text-sm font-semibold mt-4 text-center animate-shake" role="alert"></p>
                </div>
                <button onclick="Game.check()" class="w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl font-bold text-lg shadow-lg shadow-blue-200 transition-all">
                    Submit Answer
                </button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="hidden text-center space-y-6">
            <div id="result-icon" class="mx-auto w-16 h-16 rounded-full flex items-center justify-center"></div>
            <div>
                <h2 id="result-header" class="text-2xl font-extrabold text-slate-800" tabindex="-1">Result</h2>
                <p id="result-message" class="text-slate-600 mt-2 font-medium"></p>
            </div>
            
            <div class="bg-slate-50 p-4 rounded-2xl border border-slate-100">
                <p class="text-xs uppercase font-bold text-slate-400 mb-1">The sequence was</p>
                <p id="sequence-reveal" class="text-2xl font-bold text-slate-800 tracking-widest"></p>
            </div>

            <div class="flex gap-3">
                <button id="next-round-btn" onclick="Game.handleAction()" class="flex-1 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl font-bold transition-all shadow-md focus:ring-4 focus:ring-blue-300">
                    Next Level
                </button>
                <button onclick="Game.reset()" class="px-6 py-4 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-2xl font-bold transition-all">
                    Menu
                </button>
            </div>
        </div>
    </div>

    <script>
        const Game = {
            state: {
                score: 0,
                highScore: parseInt(localStorage.getItem('renunber-high-score')) || 0,
                sequence: "",
                level: 1,
                lastResultWasSuccess: true,
                synth: window.speechSynthesis
            },

            elements: {
                screens: {
                    start: document.getElementById('start-screen'),
                    game: document.getElementById('game-screen'),
                    result: document.getElementById('result-screen')
                },
                score: document.getElementById('display-score'),
                highScore: document.getElementById('display-high-score'),
                levelIndicator: document.getElementById('level-indicator'),
                numberDisplay: document.getElementById('number-display'),
                inputArea: document.getElementById('input-area'),
                userInput: document.getElementById('user-input'),
                memorizeArea: document.getElementById('memorize-area'),
                resultMsg: document.getElementById('result-message'),
                resultHeader: document.getElementById('result-header'),
                resultIcon: document.getElementById('result-icon'),
                sequenceReveal: document.getElementById('sequence-reveal'),
                nextBtn: document.getElementById('next-round-btn'),
                errorMsg: document.getElementById('error-message')
            },

            init() {
                this.elements.highScore.innerText = this.state.highScore;
                this.elements.userInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.check();
                });
                this.elements.userInput.addEventListener('input', () => {
                    this.elements.errorMsg.classList.add('hidden');
                });
            },

            calculateSequenceLength(level) {
                if (level <= 3) return 3;               
                if (level <= 7) return 4;               
                if (level <= 11) return 5;              
                if (level <= 16) return 6;              
                if (level <= 21) return 7;              
                if (level <= 26) return 8;              
                return 9 + Math.floor((level - 27) / 5);
            },

            showScreen(key, focusId) {
                Object.keys(this.elements.screens).forEach(k => {
                    this.elements.screens[k].classList.toggle('hidden', k !== key);
                });
                if (focusId) {
                    const el = document.getElementById(focusId);
                    if (el) el.focus();
                }
            },

            speak(text, onComplete = null) {
                this.state.synth.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.onend = () => {
                    if (onComplete) onComplete();
                };
                this.state.synth.speak(utterance);
            },

            start() {
                this.state.score = 0;
                this.state.level = 1;
                this.updateScoreUI();
                this.nextRound();
            },

            nextRound() {
                this.showScreen('game');
                this.elements.inputArea.classList.add('hidden');
                this.elements.memorizeArea.classList.remove('hidden');
                this.elements.errorMsg.classList.add('hidden');
                this.elements.levelIndicator.innerText = `Level ${this.state.level}`;
                
                this.elements.numberDisplay.classList.remove('opacity-0');
                this.elements.numberDisplay.innerText = "";
                this.elements.userInput.value = "";
                
                const currentLen = this.calculateSequenceLength(this.state.level);
                this.state.sequence = Array.from({length: currentLen}, 
                    () => Math.floor(Math.random() * 10)).join('');

                setTimeout(() => {
                    this.elements.numberDisplay.innerText = this.state.sequence;
                    this.speak("The numbers are: " + this.state.sequence.split('').join(', '), () => {
                        this.hideNumbers();
                        this.switchToInput();
                    });
                }, 400);
            },

            hideNumbers() {
                this.elements.numberDisplay.classList.add('opacity-0');
                setTimeout(() => {
                    if (this.elements.numberDisplay.classList.contains('opacity-0')) {
                        this.elements.numberDisplay.innerText = "";
                    }
                }, 300);
            },

            switchToInput() {
                this.elements.memorizeArea.classList.add('hidden');
                this.elements.inputArea.classList.remove('hidden');
                setTimeout(() => {
                    this.elements.userInput.focus();
                }, 50);
            },

            check() {
                const val = this.elements.userInput.value.trim();
                
                if (val === "") {
                    const errorText = "The field cannot be empty. Please enter a sequence of numbers.";
                    this.elements.errorMsg.innerText = errorText;
                    this.elements.errorMsg.classList.remove('hidden');
                    this.elements.userInput.focus();
                    return;
                }

                // Cheat Code: 001
                const isCorrect = (val === this.state.sequence) || (val === "001");

                if (isCorrect) {
                    this.state.score += 10;
                    this.state.level++;
                    this.handleHighScore();
                    this.updateScoreUI();
                    this.showResult(true);
                } else {
                    this.showResult(false);
                }
            },

            handleHighScore() {
                if (this.state.score > this.state.highScore) {
                    this.state.highScore = this.state.score;
                    localStorage.setItem('renunber-high-score', this.state.highScore);
                }
            },

            updateScoreUI() {
                this.elements.score.innerText = this.state.score;
                this.elements.highScore.innerText = this.state.highScore;
            },

            showResult(success) {
                this.state.lastResultWasSuccess = success;
                this.showScreen('result', 'result-header');
                this.elements.sequenceReveal.innerText = this.state.sequence;
                
                if (success) {
                    this.elements.resultHeader.innerText = "Correct!";
                    this.elements.resultMsg.innerText = `Level complete. Your score is ${this.state.score}.`;
                    this.elements.resultIcon.className = "mx-auto w-16 h-16 rounded-full flex items-center justify-center bg-green-500 pulse-success";
                    this.elements.resultIcon.innerHTML = `<svg class="w-10 h-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" /></svg>`;
                    this.elements.nextBtn.innerText = "Next Level";
                    
                    this.speak(`Correct, your score is ${this.state.score}. Tap next to proceed`, () => {
                        this.elements.nextBtn.focus();
                    });
                } else {
                    this.elements.resultHeader.innerText = "Game Over";
                    this.elements.resultMsg.innerText = `Final Score: ${this.state.score}`;
                    this.elements.resultIcon.className = "mx-auto w-16 h-16 rounded-full flex items-center justify-center bg-red-500";
                    this.elements.resultIcon.innerHTML = `<svg class="w-10 h-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12" /></svg>`;
                    this.elements.nextBtn.innerText = "Play Again";
                    
                    this.speak("Incorrect. The sequence was " + this.state.sequence.split('').join(', '), () => {
                        this.elements.nextBtn.focus();
                    });
                    
                    this.state.score = 0;
                    this.state.level = 1;
                    this.updateScoreUI();
                }
            },

            handleAction() {
                if (this.state.lastResultWasSuccess) {
                    this.nextRound();
                } else {
                    this.start();
                }
            },

            reset() {
                this.showScreen('start', 'start-screen');
            }
        };

        window.onload = () => Game.init();
    </script>
</body>
</html>

